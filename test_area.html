<!DOCTYPE html>
<html lang="en">
    <style>
    </style>
    <head>
        <meta charset="utf-8">
        <title>Testing Stuff</title>
        <script src="https://d3js.org/d3.v7.min.js"></script>
        <script src="class_definitions.js"></script>
        <script src="MMP_JS.js"></script>

        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" media="all" />
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css"
            media="all" />
        <link rel="stylesheet" href="styles.css" />
      
        <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    </head>
    <body>
    
        <div id="main_timeline">
            <svg id="svg">
                <defs>
                    <marker id="arrow" viewBox="0 0 10 10" refX="5" refY="5"
                        markerWidth="6" markerHeight="6"
                        orient="auto-start-reverse">
                        <path d="M 0 0 L 10 5 L 0 10 z" />
                    </marker>
                </defs>
                <line x1="500" x2="400" y1="50" y2="125" stroke="black"  marker-end="#url(arrow)"/>
                <polyline points="10,10 10,90 90,90" fill="none" stroke="black"
                marker-start="url(#arrow)" marker-end="url(#arrow)" />
            </svg>
        </div>

        <button id="jumpButton" onclick="handleAnimation()">jump randomly!</button>
        <input type="range" min="0" max="3" step="1" value="1" id="zoomRange" oninput="handleAnimatedSlider()">

        <script type="text/javascript">
            var svg = d3.select("#svg")
            .attr("height", 500).attr("width", 1000)
            .attr("style", "outline: thin solid red");

            var main_g = svg.append("g").attr("id", "main_g");

            square_size = 50;

            var test_data = {
                1: {x: 0, y: 0},
                2: {x: square_size, y:square_size},
                3: {x: 2*square_size, y:2*square_size},
                4: {x: 3*square_size, y:3*square_size}

            }
            /*var rect = main_g.selectAll('foo').data(Object.values(test_data)).enter().append('rect')
            .attr("height", square_size).attr("width", square_size)
            .attr("x", function(d){return d.x})
            .attr("y", function(d){return d.y})
            .attr("stroke",  "red");*/

            var defs = main_g.append("defs");
            
            defs.append("marker")
            .attr("id", "triangle")
            .attr("refX", 13)
            .attr("refY", 5)
            .attr("markerWidth", 30)
            .attr("markerHeight", 30)
            .attr("markerUnits","userSpaceOnUse")
            .attr("orient", "auto")
            .append("path")
            .attr("d", "M 0 0 12 6 0 12 3 6")
            .style("fill", "#555");

            const split_mid = "M 90 -195 L -90 195";
            defs.append("marker").attr("id", "splitmid")
            .attr("refX", 0).attr("refY", 0).attr("markerWidth", 50).attr("markerHeight", 50).attr("orient", "auto")
            .append("path").attr("d", split_mid).attr("fill", "black");


            var line = main_g.append('polyline')
            .attr("points", "500,50 500,75 500,100 500,125")
            .attr("stroke", "red").attr("fill", "none")
            .attr("marker-mid", "url(#splitmid)");

            function updateData(){
                for (id in test_data){
                    test_data[id].x = 50;
                }
            }

            function handleAnimation(){
                d3.selectAll('rect').transition().duration(1000).attr("x", function(d){return d.x}).attr("y", function(d){return d.y});
            }

            function handleAnimatedSlider(){
                let slider = document.getElementById("zoomRange");
                d3.select('rect').transition().duration(1000).attr("x", square_size*slider.value);
            }

        </script>
    </body>
</html>